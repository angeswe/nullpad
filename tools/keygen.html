<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self' fonts.googleapis.com; font-src fonts.gstatic.com; frame-ancestors 'none'; base-uri 'self'; form-action 'none'">
    <title>Nullpad Admin Keypair Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="keygen.css" integrity="sha384-A1Be9+JuujVc8SqYvpgifzp44iA+RV8lp/OrE5phWbRsXtlGUqJIXVxea39MOwTL">
</head>
<body>
    <div class="container">
        <h1>Nullpad Admin Keypair Generator</h1>
        <div class="subtitle">Ed25519 keypair generator for admin bootstrap</div>

        <div class="warning">
            <strong>Security Warning</strong>
            Save your secret key securely. It cannot be recovered. Anyone with access to the secret key can authenticate as admin.
        </div>

        <button id="generateBtn">Generate New Keypair</button>

        <div class="key-section">
            <h2>Public Key</h2>
            <div class="label">Use this for the ADMIN_PUBKEY environment variable</div>
            <div class="key-display">
                <textarea id="pubkeyField" readonly></textarea>
                <button class="copy-btn" data-target="pubkeyField">Copy</button>
            </div>
            <div class="usage-note">
                Set in .env: <code>ADMIN_PUBKEY=&lt;public key&gt;</code>
            </div>
        </div>

        <div class="key-section">
            <h2>Secret Key</h2>
            <div class="label">Store this securely â€” required for admin authentication</div>
            <div class="key-display">
                <textarea id="secretkeyField" readonly></textarea>
                <button class="copy-btn" data-target="secretkeyField">Copy</button>
            </div>
            <div class="usage-note">
                Keep this secret safe. You'll need it to sign challenges when logging in as admin.
            </div>
        </div>

        <footer>
            Nullpad Admin Keypair Generator | Ed25519 via Web Crypto API
        </footer>
    </div>

    <script src="keygen.js" integrity="sha384-Gsw3mpeqDb2Q4MNXu30wMlYDf0jgt+w4eUBHySazyo1VS/EJYHNWUwxVm2UVoJO6"></script>
</body>
</html>
