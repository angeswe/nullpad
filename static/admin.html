<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'wasm-unsafe-eval'; style-src 'self' fonts.googleapis.com; font-src fonts.gstatic.com">
  <title>Admin Dashboard - Nullpad</title>
  <link rel="icon" href="/favicon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="container">
    <div class="page-header">
      <div class="flex justify-between items-center">
        <div>
          <h1>Admin Dashboard</h1>
          <p>Manage users, invites, and system statistics</p>
        </div>
        <div class="action-buttons">
          <a href="/trusted.html" class="btn btn-secondary btn-small">Upload</a>
          <button id="logout-btn" class="btn btn-secondary btn-small">Logout</button>
        </div>
      </div>
    </div>

    <!-- Statistics -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value" id="stat-users">-</div>
        <div class="stat-label">Active Users</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="stat-pastes">-</div>
        <div class="stat-label">Active Pastes</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="stat-invites">-</div>
        <div class="stat-label">Pending Invites</div>
      </div>
    </div>

    <!-- Invites Management -->
    <div class="panel">
      <div class="panel-header">
        <div class="flex justify-between items-center">
          <h2>Invitations</h2>
          <button id="create-invite-btn" class="btn btn-primary btn-small">Create Invite</button>
        </div>
      </div>
      <div class="panel-body">
        <div id="invite-success" class="alert alert-success hidden">
          <p><strong>Invite created!</strong> Share this link:</p>
          <div class="copy-wrapper">
            <input type="text" id="invite-url" class="copy-input" readonly>
            <button id="copy-invite-btn" class="copy-btn">Copy</button>
          </div>
        </div>

        <table id="invites-table">
          <thead>
            <tr>
              <th>Token</th>
              <th>Created</th>
              <th>Expires</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="invites-list">
            <tr>
              <td colspan="4" class="text-center text-muted">Loading invites...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Users Management -->
    <div class="panel">
      <div class="panel-header">
        <h2>Trusted Users</h2>
      </div>
      <div class="panel-body">
        <table id="users-table">
          <thead>
            <tr>
              <th>Alias</th>
              <th>User ID</th>
              <th>Public Key</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="users-list">
            <tr>
              <td colspan="4" class="text-center text-muted">Loading users...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Paste Management -->
    <div class="panel">
      <div class="panel-header">
        <h2>Paste Management</h2>
      </div>
      <div class="panel-body">
        <p class="text-muted">
          Delete specific pastes by ID. This is useful for removing abusive content or managing storage.
        </p>
        <form id="delete-paste-form">
          <div class="flex gap-2">
            <input type="text" id="paste-id" name="paste-id" placeholder="Enter paste ID" required>
            <button type="submit" class="btn btn-danger">Delete Paste</button>
          </div>
        </form>
        <div id="paste-delete-success" class="alert alert-success hidden mt-2">
          Paste deleted successfully.
        </div>
        <div id="paste-delete-error" class="alert alert-error hidden mt-2"></div>
      </div>
    </div>

    <div id="error-message" class="alert alert-error hidden"></div>
  </div>

  <footer class="site-footer">
    <a href="https://github.com/glow/nullpad" target="_blank" rel="noopener">GitHub</a>
  </footer>

  <!-- TODO: Add SRI hashes after finalizing vendor library versions -->
  <script src="/js/vendor/argon2.umd.min.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/admin.js"></script>
</body>
</html>
